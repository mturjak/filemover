<!DOCTYPE html>
<html>
<head>
 	<meta charset="utf-8">
  <title>mturjak/filemover - demo</title>
 	<link rel="stylesheet" type="text/css" href="css/demo.css">
 	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
  <script src="js/jquery.filemover.min.js"></script>
</head>
<body>
 	<header class="main-header">
 		<h1>Demo - <a href="https://github.com/mturjak/filemover">mturjak/filemover</a></h1>
 	</header>
 	<section id="main-content">
 	<div class="console"></div>
  <h3>/</h3>
 	<ul id="f1" class="file-list">
    <button class="move" data-origin="" data-target="test" data-tid="#f2">MOVE TO /test/</button>
 	  <li class="file" data-fname="test1.txt">test1.txt<input class="to_move" type="checkbox" /></li>
    <li class="file" data-fname="test2.txt">test1.txt<input class="to_move" type="checkbox" /></li>
 	</ul>
  <h3>/test/</h3>
  <ul id="f2" class="file-list">
    <button class="move" data-origin="test" data-target="" data-tid="#f1">MOVE TO /</button>
  </ul>
	</section>
 	<footer>
 	</footer>
  <script type="text/javascript">
    $(function(){
      $('.file-list').on('change', 'input.to_move', function(){
        $(this).parent().toggleClass('selected');
      });
      $('.move').on('click', function(){
        var origin = ( $(this).data('origin') == '' ? '' : $(this).data('origin') + '/'),
            target = $(this).data('target'),
            targetId = $(this).data('tid');
        $(this).siblings('li.selected').filemover( target, function(obj, res){
          $.each( res, function(i){
            console.log(obj[i] + "  " + targetId );
            $('.console').append( "<p>"+this.message+"</p>" );
            if( this.done ) {
              var fn = $(obj[i]).data('fname').replace( origin, '' );
              $(obj[i]).data('fname', target + '/' + fn).appendTo(targetId);
            }
          });
        });
      });
    });
  </script>
</body>
</html>